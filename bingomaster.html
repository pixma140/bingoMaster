<!DOCTYPE html>
<html>
    <head>
        <title>BingoMaster</title>
        
        <!-- jQuery -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>     
        
        <!-- Bootstrap -->        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.js"></script>             
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.js"></script>                         
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.css">                    
        
        <style>
			#myBtn{    
				padding-top: 0 !important;
			}
			
			//.btn-danger { border-color: black; }			
			//.btn-success { border-color: black; }

			//.btn-danger { background-color: blue; border-color: black; }			
			//.btn-success { background-color: pink; border-color: black; }

			// button override (failed due to bootstrap shit...
			.myBtn {
				display: table-cell;
				vertical-align: middle;
				padding-top: 0px;
				padding-bottom: 0px;
				height: 35px;
				line-height: 35px;
				//padding: 0;
				//margin: 0;
			}
			
        </style>		
        <meta charset="utf-8">
    </head>
    
    <body style="background-color: black; color: white; background-repeat: no-repeat;"> <!-- background-image: url('flames.jpg'); -->
    
        <div style="width:100%; margin-top: 1em;">                    
            <div style="width: 75%; margin: 0 auto;">
			
				<!-- AUDIO ELEMENT FOR PLAYBACK -->
				<audio id="myAudio" hidden controls>
					<source id="audioSource" src="" type="audio/mpeg">                        
                </audio>

				<!-- VIDEO ELEMENT FOR PLAYBACK -->				
				<dialog id="dialog" width="100%" style="padding: 0px; margin-top: 1em">
					<video width="1000px" id="myVideo">
						<source id="videoSource" src="" type="video/mp4">
					</video>
				</dialog>
				
				<!-- HEADLINE -->
                <h2 style="background-color: black; text-align: center; opacity:1; border-radius: 25px; padding: 5px;"><strong>Bingo Master - </strong>Anzahl Zahlen: <span id="myAnz" style="font-weight: bold;">0</span> - Letzte Gezogene: <span id="myLast" style="font-weight: bold;"></span></h2> <!--  - <span id="mySearch">Gesucht wird <b>eine volle Reihe!</b></span> -->
				
				<!-- PAST NUMBERS ARRAY -->
                <!-- <h2 style="background-color: black; opacity:1;border-radius: 5px; padding: 5px;"><small>Gezogene Zahlen: <span id="myNumb"></span></small></h2> --> <!-- SORTED ARRAY -->
				<h2 style="background-color: black; opacity:1;border-radius: 5px; padding: 5px;"><small>Gezogene Zahlen: <strong><span id="myNumbUnsort"></span></strong></small></h2> <!-- UNSORTED ARRAY -->
            	
                <hr style="border-color:white;">
                
                <div id="buttonList" style="text-align: center; background-color: black;"> <!-- margin: 0 auto; background-color: black; opacity:0.75; -->
                    <!-- EMPTY DIV TO BE FILLED ON DOCUMENT READY WITH  BUTTON ARRAY -->
                </div>
                
                <hr style="border-color:white;">
            </div>
        </div>
        
        <marquee id="marquee" scrollamount="15" direction="left"><strong>+ + + HIER KÖNNTE IHRE WERBUNG STEHEN! + + + LAMPE STINKT (HEUTE NICHT WEIL FRISCH GEDUSCHT) + + + WER DAS LIEST IST DOOF + + + HALLO ECHOOO + + + HALLO LAMPEEE + + +</strong></marquee>
		<!-- <marquee id=marquee" scrollamount="15" behavior="alternate"><strong>+ + + TERMINE + + + sadfsdaf + + +</strong></marquee> -->
        
        <script>
		
			// ================================================
			// ======================= DECLARATION OF VARIABLES
			// ================================================
			
            var counter = 0;
            var numberArray = [];
            var numberArrayUnsort = [];
            var state = 0;
			
			// ================================================
			// ============================== SEKÜNDLICHER POLL
			// ================================================

			setInterval(doReq, 5000);

			function doReq() {
				$.ajax({
						url: 'https://baconipsum.com/api/?type=meat-and-filler&paras=&format=text',
						dataType: 'text',
						type: 'GET',
						success: function(data){
								console.log(data);
						},
						error: function(jqXhr, textStatus, errorThrown){
								console.log(errorThrown);
						}
				});
			}
			
			// ================================================
			// ================================== RANDOMIZATION
			// ================================================
			
			/* var lfrandom = getRandomInt(3) + 2;
			var lsrandom = getRandomInt(3) + 2;
			
			var frandom = getRandomInt(20) + 5;
			var efrandom = frandom + lfrandom;
			
			var srandom = getRandomInt(10) + frandom + 5;
			var esrandom = srandom + lsrandom;
			
			console.log("First change: " + frandom);
			console.log("First length: " + lfrandom);
			
			console.log("Second change: " + srandom);
			console.log("Second length: " + lsrandom); */
            
			// ================================================
			// ====================== BUILD NUMBER BUTTON ARRAY
			// ================================================
			
            $(document).ready(function(){                
            
                // button var 1
                for (var i = 1; i <= 90; i++) {                    
                    $("#buttonList").append("<input id='myBtn" + i + "' class='btn btn-danger m-1' style='width: 4%; padding: 0px; height: 35px; text-align: center; display: inline-block; font-weight: bold; font-size: 26px;' onclick='lol(" + i + ")' value='" + i + "' type='button'/>");
                    
                     //how many buttons per row
                     if (i % 20 == 0) {
                        $("#buttonList").append("<br>");
                    }
                }
            });
            
			
			// ================================================
			// ================================ BUTTON HANDLING
			// ================================================
			
            function lol(myVar) {
			
				// if not clicked
                if($('#myBtn' + myVar).hasClass("btn btn-danger m-1")) {
					
					// select song if matching number
					switch(myVar) {
						case 6:
							playMusic("sexbomb", 46.4, 5800);							
							break;
						case 7:
							playMusic("zwerge", 19.3, 5000);
							break;
						case 9:
							playMusic("pipi", 11.4, 5000);
							break;
						case 43:
							playMusic("whooo", 0.1, 2000);
							break;
						case 63:
							playMusic("depp", 93.5, 6000);
							break;
						case 66:
							playMusic("sechs", 52.2, 7600);
							break;
						case 69:
							playMusic("joe", 0, 10500);
							break;
						default:
							// NOTHING
							break;
					}
					
					// select video if matching number
					switch(myVar) {
						case 42:
							//playVideo("deepthought", 0.15, 1330);							
							break;
						default:
							// NOTHING
							break;
					}
					
                    counter++;
                    
                    numberArray.push(myVar);
                    numberArrayUnsort.push(myVar);
                    
                    $('#myBtn' + myVar).removeClass('btn btn-danger m-1');
                    $('#myBtn' + myVar).addClass('btn btn-success m-1');
                    
                    $('#myAnz').html(counter);
                    $('#myLast').html(numberArrayUnsort[numberArrayUnsort.length - 1]);
                    $('#myNumb').html(numberArray.sort(function(a, b){return a - b}).join(" - "));
                    $('#myNumbUnsort').html(numberArrayUnsort.join(" - "));
					
				// if already clicked
                } else {
                    counter--;
					
					// stop music if number was wrong
					pauseMusic();
                    
                    numberArray = arrayRemove(numberArray, myVar);
                    numberArrayUnsort = arrayRemove(numberArrayUnsort, myVar);
                    
                    $('#myBtn' + myVar).removeClass('btn btn-success m-1');
                    $('#myBtn' + myVar).addClass('btn btn-danger m-1');
                    
                    $('#myAnz').html(counter);
                    $('#myLast').html(numberArrayUnsort[numberArrayUnsort.length - 1]);
                    $('#myNumb').html(numberArray.sort(function(a, b){return a - b}).join(" - "));
                    $('#myNumbUnsort').html(numberArrayUnsort.join(" - "));
                }
				
				// if no number was fetched, no display of last number
				if (counter == 0) {
					$('#myLast').html("");
				}
				
				// color change mode (always)
				/* if (counter >= frandom && counter <= efrandom) {
				
					$(document.body).css("background-color","purple");
					$("#buttonList").css("background-color","purple");
					
				} else if (counter >= srandom && counter <= esrandom){
				
					$(document.body).css("background-color","#EA0A8E");
					$("#buttonList").css("background-color","#EA0A8E");
					
				} else {
				
					$(document.body).css("background-color","black");
					$("#buttonList").css("background-color","black");
				} */
            }
            
			
            // ================================================
			// ================================= MUSIC HANDLING
			// ================================================
			
			function playMusic(mySong, myStartTime, myLength) {
				console.log("play: " + mySong + " from: " + myStartTime + " for: " + myLength/1000 + " seconds!");
			
                var x = document.getElementById("myAudio");
				var source = document.getElementById('audioSource');
				var newSource = "music\/" + mySong + ".mp3";				
				source.src = newSource;
				
				x.load();
				x.currentTime = myStartTime;
                x.play();
				
				// play mySong for myLength seconds from  myStartTime at point of pressing given number
                setTimeout(pauseMusic, myLength);
            }
			
            function pauseMusic() {                
                var x = document.getElementById("myAudio");
                x.pause();
            }
			
			// ================================================
			// ================================= VIDEO HANDLING
			// ================================================
			
			function playVideo(myVideo, myStartTime, myLength) {
				console.log("play: " + myVideo + " from: " + myStartTime + " for: " + myLength/1000 + " seconds!");
			
                var x = document.getElementById("myVideo");
				var source = document.getElementById('videoSource');
				var newSource = "video\/" + myVideo + ".mp4";				
				source.src = newSource;
			
				document.getElementById('dialog').showModal();			
				document.getElementById("marquee").style.display = "none";
			
				x.load();
				x.currentTime = myStartTime;
				x.volume = 1.0;
                x.play();
				
				// play mySong for myLength seconds from  myStartTime at point of pressing given number
                setTimeout(pauseVideo, myLength);
            }
			
            function pauseVideo() {                
                var x = document.getElementById("myVideo");
                x.pause();
				
				document.getElementById("dialog").close();
				document.getElementById("marquee").style.display = "block";
            }
			
			
			// ================================================
			// =============================== HELPER FUNCTIONS
			// ================================================
			
			function arrayRemove(arr, value) {
                return arr.filter(function(ele){
                    return ele != value;
                });
            }
			
			function getRandomInt(max) {
				return Math.floor(Math.random() * Math.floor(max));
			}
        </script>
    </body>
</html>